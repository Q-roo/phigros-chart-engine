using System;

namespace PCE.Chartbuild;

public static class TokenTypeExtensions
{
    public static string ToSourceString(this TokenType type)
    {
        return type switch
        {
            TokenType.Unknown            => "unknown",
            TokenType.Identifier         => "identifier",
            TokenType.Literal            => "literal",
            TokenType.StringLiteral      => "string",
            TokenType.IntLiteral         => "int",
            TokenType.FloatLiteral       => "float",
            TokenType.LessThan           => "<",
            TokenType.LessThanOrEqual    => "<=",
            TokenType.GreaterThan        => ">",
            TokenType.GreaterThanOrEqual => ">=",
            TokenType.Equal              => "==",
            TokenType.NotEqual           => "!=",
            TokenType.And                => "&&",
            TokenType.Or                 => "||",
            TokenType.Not                => "!",
            TokenType.BitwiseAnd         => "&",
            TokenType.BitwiseOr          => "|",
            TokenType.BitwiseNot         => "~",
            TokenType.BitwiseXor         => "^",
            TokenType.ShiftLeft          => "<<",
            TokenType.ShiftRight         => ">>",
            TokenType.Plus               => "+",
            TokenType.Minus              => "-",
            TokenType.Multiply           => "*",
            TokenType.Power              => "**",
            TokenType.Divide             => "/",
            TokenType.Modulo             => "%",
            TokenType.Assign             => "=",
            TokenType.DotAssign          => ".=",
            TokenType.PlusAssign         => "+=",
            TokenType.MinusAssign        => "-=",
            TokenType.MultiplyAssign     => "*=",
            TokenType.PowerAssign        => "**=",
            TokenType.DivideAssign       => "/=",
            TokenType.ModuloAssign       => "%=",
            TokenType.ShiftLeftAssign    => "<<=",
            TokenType.ShiftRightAssign   => ">>=",
            TokenType.BitwiseAndAssign   => "&=",
            TokenType.BitwiseOrAssign    => "|=",
            TokenType.BitwiseXorAssign   => "^=",
            TokenType.BitwiseNotAssign  => "~=",
            TokenType.Increment          => "++",
            TokenType.Decrement          => "--",
            TokenType.If                 => "if",
            TokenType.Else               => "else",
            TokenType.QuestionMark       => "?",
            TokenType.For                => "for",
            TokenType.While              => "while",
            TokenType.Break              => "break",
            TokenType.Continue           => "continue",
            TokenType.Return             => "return",
            TokenType.Switch             => "switch",
            TokenType.Case               => "case",
            TokenType.Let                => "let",
            TokenType.Const              => "const",
            TokenType.Fn                 => "fn",
            TokenType.In                 => "in",
            TokenType.LeftBracket        => "[",
            TokenType.RightBracket       => "]",
            TokenType.LeftBrace          => "{",
            TokenType.RightBrace         => "}",
            TokenType.LeftParenthesis    => "(",
            TokenType.RightParenthesis   => ")",
            TokenType.Coma               => ",",
            TokenType.Semicolon          => ";",
            TokenType.Dot                => ".",
            TokenType.DotDot             => "..",
            TokenType.DotDotEqual        => "..=",
            TokenType.Colon              => ":",
            TokenType.RightArrow     => "->",
            // TokenType.RightArrowThick => "=>",
            TokenType.Hash               => "#",
            TokenType.Eof                => "EOF",
            _                            => "???"
        };
    }

    public static OperatorType ToOperator(this TokenType token) => token switch {
            TokenType.LessThan           => OperatorType.LessThan,
            TokenType.LessThanOrEqual    => OperatorType.LessThanOrEqual,
            TokenType.GreaterThan        => OperatorType.GreaterThan,
            TokenType.GreaterThanOrEqual => OperatorType.GreaterThanOrEqual,
            TokenType.Equal              => OperatorType.Equal,
            TokenType.NotEqual           => OperatorType.NotEqual,
            TokenType.And                => OperatorType.And,
            TokenType.Or                 => OperatorType.Or,
            TokenType.Not                => OperatorType.Not,
            TokenType.BitwiseAnd         => OperatorType.BitwiseAnd,
            TokenType.BitwiseOr          => OperatorType.BitwiseOr,
            TokenType.BitwiseNot         => OperatorType.BitwiseNot,
            TokenType.BitwiseXor         => OperatorType.BitwiseXor,
            TokenType.ShiftLeft          => OperatorType.ShiftLeft,
            TokenType.ShiftRight         => OperatorType.ShiftRight,
            TokenType.Plus               => OperatorType.Plus,
            TokenType.Minus              => OperatorType.Minus,
            TokenType.Multiply           => OperatorType.Multiply,
            TokenType.Power              => OperatorType.Power,
            TokenType.Divide             => OperatorType.Divide,
            TokenType.Modulo             => OperatorType.Modulo,
            TokenType.Increment          => OperatorType.Increment,
            TokenType.Decrement          => OperatorType.Decrement,
            // assignments
            TokenType.PlusAssign         => OperatorType.Plus,
            TokenType.MinusAssign        => OperatorType.Minus,
            TokenType.MultiplyAssign     => OperatorType.Multiply,
            TokenType.PowerAssign        => OperatorType.Power,
            TokenType.DivideAssign       => OperatorType.Divide,
            TokenType.ModuloAssign       => OperatorType.Modulo,
            TokenType.ShiftLeftAssign    => OperatorType.ShiftLeft,
            TokenType.ShiftRightAssign   => OperatorType.ShiftRight,
            TokenType.BitwiseAndAssign   => OperatorType.BitwiseAnd,
            TokenType.BitwiseOrAssign    => OperatorType.BitwiseOr,
            TokenType.BitwiseXorAssign   => OperatorType.BitwiseXor,
            _ => throw new InvalidOperationException($"{token.ToSourceString()} is not an operator")
    };
}